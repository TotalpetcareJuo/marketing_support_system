<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>새 계약서 작성 - 주오컴퍼니</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="css/materials.css">
    <link rel="stylesheet" as="style" crossorigin
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard-dynamic-subset.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body {
            font-family: 'Pretendard', 'Noto Sans KR', sans-serif;
            background-color: #f8fafc;
        }
        .text-juo-orange { color: #FF7A00; }
        .bg-juo-orange { background-color: #FF7A00; }
        .ring-juo-orange { --tw-ring-color: #FF7A00; }
    </style>
</head>

<body class="bg-slate-50 h-screen flex flex-col overflow-hidden">

    <header class="bg-white border-b border-slate-200 shrink-0 z-20">
        <div class="h-16 px-4 md:px-6 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <button onclick="history.back()"
                    class="touch-btn flex items-center justify-center hover:bg-slate-100 rounded-xl text-slate-500 transition">
                    <i data-lucide="arrow-left" class="w-6 h-6"></i>
                </button>
                <h1 class="text-lg font-bold text-slate-800 flex items-center gap-2">
                    <i data-lucide="file-signature" class="w-5 h-5 text-juo-orange"></i>
                    <span id="page-title">새 계약서 작성</span>
                </h1>
            </div>
            <div class="flex items-center gap-3">
                <button id="btn-cancel"
                    class="flex items-center gap-2 px-4 py-2 rounded-xl bg-slate-100 hover:bg-slate-200 text-slate-600 font-bold transition text-sm">
                    <i data-lucide="x" class="w-4 h-4"></i>
                    <span class="hidden sm:inline">취소</span>
                </button>
            </div>
        </div>
    </header>

    <main class="flex-1 overflow-y-auto custom-scroll">
        <div class="max-w-3xl mx-auto p-4 md:p-8">
            <div class="bg-white rounded-3xl border border-slate-200 shadow-xl overflow-hidden">
                <div class="py-4 px-6 md:px-12 border-b border-slate-100 bg-white">
                    <div class="flex items-center justify-between relative">
                        <div class="absolute left-0 top-1/2 w-full h-1 bg-slate-100 -z-0"></div>
                        <div class="absolute left-0 top-1/2 w-0 h-1 bg-juo-orange -z-0 transition-all duration-300" id="step-progress-bar"></div>

                        <div class="step-item relative z-10 flex flex-col items-center gap-2 active" data-step="1">
                            <div class="w-8 h-8 rounded-full bg-slate-100 border-2 border-slate-300 text-slate-400 flex items-center justify-center text-xs font-bold transition-all duration-300 step-circle">1</div>
                            <span class="text-[10px] font-bold text-slate-400 uppercase step-label">담당자</span>
                        </div>
                        <div class="step-item relative z-10 flex flex-col items-center gap-2" data-step="2">
                            <div class="w-8 h-8 rounded-full bg-slate-100 border-2 border-slate-300 text-slate-400 flex items-center justify-center text-xs font-bold transition-all duration-300 step-circle">2</div>
                            <span class="text-[10px] font-bold text-slate-400 uppercase step-label">반려동물</span>
                        </div>
                        <div class="step-item relative z-10 flex flex-col items-center gap-2" data-step="3">
                            <div class="w-8 h-8 rounded-full bg-slate-100 border-2 border-slate-300 text-slate-400 flex items-center justify-center text-xs font-bold transition-all duration-300 step-circle">3</div>
                            <span class="text-[10px] font-bold text-slate-400 uppercase step-label">입양자</span>
                        </div>
                    </div>
                </div>

                <div class="p-6 md:p-10">
                    <form id="contract-form">
                        <div class="form-step animate-fade-in" data-step="1">
                            <h4 class="text-xl font-black text-slate-800 mb-6">입양 담당자 정보</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">입양처 (지점명)</label>
                                    <input type="text" name="manager_branch_name" required
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg"
                                        placeholder="예: 사랑해주오 입양센터 인천점">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">직원 성명</label>
                                    <input type="text" name="manager_name" required
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg"
                                        placeholder="예: 홍길동">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">주소</label>
                                    <input type="text" name="manager_branch_address" required
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg"
                                        placeholder="지점 주소를 입력하세요">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">연락처</label>
                                    <input type="tel" name="manager_phone" required
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg"
                                        placeholder="010-0000-0000">
                                </div>
                            </div>
                        </div>

                        <div class="form-step hidden animate-fade-in" data-step="2">
                            <h4 class="text-xl font-black text-slate-800 mb-6">반려동물 정보</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">이름</label>
                                    <input type="text" name="pet_name" required
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg"
                                        placeholder="예: 구름이">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">축종</label>
                                    <select name="pet_species"
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg appearance-none">
                                        <option value="dog">강아지 (Dog)</option>
                                        <option value="cat">고양이 (Cat)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">품종</label>
                                    <input type="text" name="pet_breed" required
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg"
                                        placeholder="예: 말티즈">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">모색</label>
                                    <input type="text" name="pet_color" required
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg"
                                        placeholder="예: 화이트">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">생년월일</label>
                                    <input type="date" name="pet_birthdate" required
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">성별</label>
                                    <div class="flex gap-4">
                                        <label class="flex-1 h-14 rounded-2xl bg-slate-50 border border-slate-200 flex items-center justify-center gap-2 cursor-pointer has-[:checked]:bg-blue-50 has-[:checked]:border-blue-200 has-[:checked]:text-blue-600 transition">
                                            <input type="radio" name="pet_gender" value="Male" class="hidden" checked>
                                            <span class="font-bold">남아</span>
                                        </label>
                                        <label class="flex-1 h-14 rounded-2xl bg-slate-50 border border-slate-200 flex items-center justify-center gap-2 cursor-pointer has-[:checked]:bg-red-50 has-[:checked]:border-red-200 has-[:checked]:text-red-600 transition">
                                            <input type="radio" name="pet_gender" value="Female" class="hidden">
                                            <span class="font-bold">여아</span>
                                        </label>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">입수일자</label>
                                    <input type="date" name="pet_acquisition_date"
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg">
                                </div>
                            </div>
                        </div>

                        <div class="form-step hidden animate-fade-in" data-step="3">
                            <h4 class="text-xl font-black text-slate-800 mb-6">입양자 정보</h4>
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">성명</label>
                                    <input type="text" name="adopter_name" required
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg"
                                        placeholder="홍길동">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">주민등록번호 (앞 7자리)</label>
                                    <input type="text" name="adopter_id_num" required
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg tracking-widest"
                                        placeholder="800101-1" maxlength="8">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">연락처</label>
                                    <input type="tel" name="adopter_phone" required
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg"
                                        placeholder="010-0000-0000">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">주소</label>
                                    <input type="text" name="adopter_address" required
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg mb-2"
                                        placeholder="주소를 입력하세요">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 mb-2 ml-1">입양비</label>
                                    <input type="number" name="adoption_fee"
                                        class="w-full h-14 px-4 rounded-2xl bg-slate-50 border border-slate-200 focus:border-juo-orange focus:ring-2 focus:ring-orange-100 outline-none transition font-bold text-lg"
                                        placeholder="0">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="h-20 border-t border-slate-100 bg-slate-50 px-6 flex items-center justify-between">
                    <button type="button" id="btn-prev-step"
                        class="hidden px-6 py-3 rounded-xl bg-slate-100 text-slate-600 font-bold hover:bg-slate-200 transition">
                        이전
                    </button>
                    <div class="ml-auto flex gap-3">
                        <button type="button" id="btn-draft-save"
                            class="px-6 py-3 rounded-xl bg-slate-200 text-slate-600 font-bold hover:bg-slate-300 transition flex items-center gap-1.5">
                            <i data-lucide="save" class="w-4 h-4"></i> 임시저장
                        </button>
                        <button type="button" id="btn-next-step"
                            class="px-8 py-3 rounded-xl bg-slate-900 text-white font-bold hover:bg-slate-800 transition shadow-lg shadow-slate-200">
                            다음 단계 <i data-lucide="arrow-right" class="w-4 h-4 inline ml-1"></i>
                        </button>
                        <button type="button" id="btn-save-contract"
                            class="hidden px-8 py-3 rounded-xl bg-juo-orange text-white font-bold hover:bg-orange-600 transition shadow-lg shadow-orange-200">
                            <i data-lucide="check" class="w-4 h-4 inline mr-1"></i> 계약서 저장
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="contract-preview-overlay" class="hidden fixed inset-0 z-[60] bg-slate-900/60 backdrop-blur-sm overflow-y-auto">
        <div class="min-h-screen flex flex-col items-center py-8 px-4">
            <div class="w-full max-w-[210mm] flex items-center justify-between mb-4 print:hidden">
                <h3 class="text-white font-bold text-lg">계약서 미리보기</h3>
                <div class="flex gap-3">
                    <button id="btn-print-contract" class="px-6 py-2.5 rounded-xl bg-white text-slate-800 font-bold hover:bg-slate-100 transition shadow-lg flex items-center gap-2">
                        <i data-lucide="printer" class="w-4 h-4"></i> 출력
                    </button>
                    <button id="btn-close-preview" class="px-6 py-2.5 rounded-xl bg-slate-700 text-white font-bold hover:bg-slate-600 transition shadow-lg flex items-center gap-2">
                        <i data-lucide="x" class="w-4 h-4"></i> 닫기
                    </button>
                </div>
            </div>
            <div id="contract-preview-paper" class="w-full max-w-[210mm] bg-white shadow-2xl rounded-lg print:shadow-none print:rounded-none" style="min-height: 297mm;">
                <div class="p-[10mm] print:p-[10mm]" style="font-family: 'Pretendard', 'Noto Sans KR', sans-serif;">
                    <div class="text-center mb-3">
                        <h1 class="text-xl font-black tracking-tight mb-0.5">입양 계약서</h1>
                        <p class="text-xs text-slate-400">사랑해주오 입양센터</p>
                        <div class="mt-0.5 text-[11px] text-slate-400" id="preview-contract-number"></div>
                    </div>
                    <hr class="border-slate-300 mb-3">
                    <div class="mb-2">
                        <h2 class="text-sm font-black text-slate-700 mb-2 border-l-4 border-juo-orange pl-3">입양 담당</h2>
                        <table class="w-full text-[13px] border-collapse border border-slate-300">
                            <tbody>
                                <tr>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 w-24 text-center">입양처</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-manager-branch"></td>
                                </tr>
                                <tr>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 text-center">주 소</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-manager-address"></td>
                                </tr>
                                <tr>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 text-center">담당자</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-manager-name"></td>
                                </tr>
                                <tr>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 text-center">연락처</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-manager-phone"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="mb-2">
                        <h2 class="text-sm font-black text-slate-700 mb-2 border-l-4 border-blue-500 pl-3">반려동물 정보</h2>
                        <table class="w-full text-[13px] border-collapse border border-slate-300">
                            <tbody>
                                <tr>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 w-24 text-center">이름</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-pet-name"></td>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 w-24 text-center">축종</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-pet-species"></td>
                                </tr>
                                <tr>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 text-center">품종</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-pet-breed"></td>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 text-center">모색</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-pet-color"></td>
                                </tr>
                                <tr>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 text-center">성별</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-pet-gender"></td>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 text-center">생년월일</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-pet-birthdate"></td>
                                </tr>
                                <tr>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 text-center">입수일</td>
                                    <td class="border border-slate-300 px-2 py-1.5" colspan="3" id="preview-pet-intake"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="mb-2">
                        <h2 class="text-sm font-black text-slate-700 mb-2 border-l-4 border-green-500 pl-3">입양자 정보</h2>
                        <table class="w-full text-[13px] border-collapse border border-slate-300">
                            <tbody>
                                <tr>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 w-24 text-center">성명</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-adopter-name"></td>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 w-24 text-center">연락처</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-adopter-phone"></td>
                                </tr>
                                <tr>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 text-center">주민번호</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-adopter-id"></td>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 text-center">입양비</td>
                                    <td class="border border-slate-300 px-2 py-1.5" id="preview-adoption-fee"></td>
                                </tr>
                                <tr>
                                    <td class="border border-slate-300 bg-slate-50 px-2 py-1.5 font-bold text-slate-600 text-center">주소</td>
                                    <td class="border border-slate-300 px-2 py-1.5" colspan="3" id="preview-adopter-address"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="mb-2">
                        <h2 class="text-sm font-black text-slate-700 mb-2 border-l-4 border-amber-500 pl-3">입양 계약서 주요 약관 (13개항 요약)</h2>
                        <div class="text-[11px] text-slate-600 leading-snug border border-slate-300 rounded p-3 bg-slate-50">
                            <ol class="list-decimal pl-4 space-y-0">
                                <li>입양자는 입양 동물을 평생 책임지며 유기하거나 학대하지 않습니다.</li>
                                <li>입양 동물의 건강 상태를 확인하였으며, 이에 대해 이의를 제기하지 않습니다.</li>
                                <li>동물등록법에 따라 관할 구청에 동물등록을 완료해야 합니다.</li>
                                <li>예방접종 및 정기적인 검진을 통해 동물의 건강을 관리합니다.</li>
                                <li>파양 시 보호소와 사전에 반드시 협의해야 하며, 임의 양도는 금지됩니다.</li>
                                <li>주거 환경 및 가족 구성원의 동의를 모두 확인하였습니다.</li>
                                <li>입양 후 6개월간 보호소의 모니터링에 협조합니다.</li>
                                <li>중성화 수술 필요 시 적절한 시기에 진행할 것을 권장합니다.</li>
                                <li>입양비(책임비)는 반환되지 않습니다.</li>
                                <li>입양 동물의 질병 발생 시, 보호소의 연계 병원을 이용할 수 있습니다.</li>
                                <li>기타 명시되지 않은 사항은 동물보호법에 따릅니다.</li>
                                <li>본 계약의 내용을 충분히 숙지하고 동의합니다.</li>
                                <li>본 계약서는 법적 효력을 가집니다.</li>
                            </ol>
                        </div>
                    </div>
                    <div class="mt-5">
                        <p class="text-[11px] text-slate-600 mb-4">위 약관 내용을 모두 확인하였으며 이에 동의하고, 계약의 성립을 증명하기 위해 서명합니다.</p>
                        <div class="flex justify-between gap-12">
                            <div class="flex-1">
                                <div class="flex items-baseline gap-3 mb-2">
                                    <span class="text-sm font-bold text-slate-700 whitespace-nowrap">입양자</span>
                                    <span class="text-sm text-slate-700" id="preview-signer-name"></span>
                                </div>
                                <div class="border-b-2 border-slate-800 pb-4 relative">
                                    <span class="absolute right-0 bottom-1 text-[10px] text-slate-400">(서명 / 인)</span>
                                </div>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-baseline gap-3 mb-2">
                                    <span class="text-sm font-bold text-slate-700 whitespace-nowrap">담당자</span>
                                    <span class="text-sm text-slate-700" id="preview-manager-signer-name"></span>
                                </div>
                                <div class="border-b-2 border-slate-800 pb-4 relative">
                                    <span class="absolute right-0 bottom-1 text-[10px] text-slate-400">(서명 / 인)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-center mt-4 pt-3 border-t border-slate-200">
                        <p class="text-xs font-bold text-slate-500" id="preview-date"></p>
                        <p class="text-[10px] text-slate-400 mt-0.5">사랑해주오 입양센터</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="js/contract-form.js"></script>
</body>

</html>
